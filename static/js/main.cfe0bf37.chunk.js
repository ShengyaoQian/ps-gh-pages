(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{295:function(e,t,n){},297:function(e,t,n){},319:function(e,t){},321:function(e,t){},323:function(e,t){},327:function(e,t){},353:function(e,t){},355:function(e,t){},369:function(e,t){},371:function(e,t){},403:function(e,t){},405:function(e,t){},497:function(e,t){},498:function(e,t){},588:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(61),o=n.n(i),r=(n(295),n(29)),l=n(62),c=n(13),p=n(14),h=n(26),u=n(21),d=n(22),b=n(31),j=n.n(b),y=(n(297),n(631)),O=n(269),m=n(270),x=n(640),f=n(649),C=n(641),g=n(638),w=n(597),v=n(272),k=n.n(v),T=n(648),S=n(5),P=n(647),R=n(634),E=n(642),q=n(645),B=n(643),F=n(644),M=n(630),I=n(2),W=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={content:""},a.handleContentChange=a.handleContentChange.bind(Object(h.a)(a)),a.handleReply=a.handleReply.bind(Object(h.a)(a)),a}return Object(p.a)(n,[{key:"handleContentChange",value:function(e){this.setState({content:e.target.value})}},{key:"handleReply",value:function(e){e.preventDefault(),this.props.replyToPost(this.props.postId,this.state.content),this.setState({content:""}),this.props.handleCloseReply()}},{key:"render",value:function(){return Object(I.jsxs)(E.a,{open:this.props.replyToPostOpen,onClose:this.props.handleCloseReply,fullWidth:!0,maxWidth:"md",children:[Object(I.jsx)(M.a,{children:"Reply to the post"}),Object(I.jsxs)(B.a,{children:[Object(I.jsx)(F.a,{children:"Your reply will be release at close time."}),Object(I.jsx)(y.a,{spacing:2,sx:{width:"95%",m:2},children:Object(I.jsx)(R.a,{id:"outlined-multiline-static",label:"Reply",multiline:!0,rows:4,value:this.state.content,onChange:this.handleContentChange,placeholder:"Reply"})})]}),Object(I.jsxs)(q.a,{children:[Object(I.jsx)(g.a,{onClick:this.props.handleCloseReply,children:"Cancel"}),Object(I.jsx)(g.a,{onClick:this.handleReply,children:"Reply"})]})]})}}]),n}(s.a.Component),A=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(I.jsxs)(E.a,{open:this.props.showReplies,onClose:this.props.handleCloseShowReplies,fullWidth:!0,maxWidth:"lg",children:[Object(I.jsx)(M.a,{children:"Replies for this post"}),Object(I.jsx)(B.a,{children:Object(I.jsx)(y.a,{spacing:2,sx:{width:"95%",m:2},children:this.props.replies.map((function(e,t){return Object(I.jsx)(x.a,{children:Object(I.jsx)(a.Fragment,{children:Object(I.jsxs)(C.a,{children:[Object(I.jsx)(w.a,{style:{wordWrap:"break-word"},sx:{fontSize:20},color:"text.secondary",paragraph:!0,children:e.content}),Object(I.jsxs)(w.a,{style:{wordWrap:"break-word"},variant:"overline",inline:!0,gutterBottom:!0,children:["Author: ",e.author]})]})})})}))})}),Object(I.jsx)(q.a,{children:Object(I.jsx)(g.a,{onClick:this.props.handleCloseShowReplies,children:"Close"})})]})}}]),n}(a.Component),D=A,_=["expand"],H=Object(S.a)((function(e){e.expand;var t=Object(m.a)(e,_);return Object(I.jsx)(P.a,Object(O.a)({},t))}))((function(e){var t=e.theme;return{transform:e.expand?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})}})),L=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={contentExpanded:!1,replyToPostOpen:!1,showReplies:!1,replies:[]},a.handleContentExpandClick=a.handleContentExpandClick.bind(Object(h.a)(a)),a.handleClickOpenReply=a.handleClickOpenReply.bind(Object(h.a)(a)),a.handleCloseReply=a.handleCloseReply.bind(Object(h.a)(a)),a.handleShowReplies=a.handleShowReplies.bind(Object(h.a)(a)),a.handleCloseShowReplies=a.handleCloseShowReplies.bind(Object(h.a)(a)),a}return Object(p.a)(n,[{key:"handleContentExpandClick",value:function(){this.setState({contentExpanded:!this.state.contentExpanded})}},{key:"handleClickOpenReply",value:function(){this.setState({replyToPostOpen:!0})}},{key:"handleCloseReply",value:function(){this.setState({replyToPostOpen:!1})}},{key:"getReplies",value:function(){var e=Object(l.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({replies:[]}),e.next=3,this.props.publicSquare.methods.getReplyIndicesOfPost(this.props.id).call();case 3:t=e.sent,n=0;case 5:if(!(n<t.length)){e.next=13;break}return e.next=8,this.props.publicSquare.methods.getReply(t[n]).call();case 8:a=e.sent,this.setState({replies:[].concat(Object(r.a)(this.state.replies),[a])});case 10:n++,e.next=5;break;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleShowReplies",value:function(){var e=Object(l.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getReplies();case 2:this.setState({showReplies:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleCloseShowReplies",value:function(){this.setState({showReplies:!1})}},{key:"render",value:function(){var e=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(1e3*this.props.closeTimestamp),t=(new Date).getTime()>1e3*this.props.closeTimestamp;return Object(I.jsx)(x.a,{variant:"outlined",children:Object(I.jsxs)(a.Fragment,{children:[Object(I.jsxs)(C.a,{children:[Object(I.jsx)(w.a,{style:{wordWrap:"break-word"},sx:{fontSize:30},color:"text.secondary",gutterBottom:!0,children:this.props.title}),Object(I.jsxs)(w.a,{variant:"overline",display:"block",sx:{m:2},gutterBottom:!0,children:["Author: ",this.props.author]})]}),Object(I.jsx)(H,{expand:this.state.contentExpanded,onClick:this.handleContentExpandClick,"aria-expanded":this.state.contentExpanded,"aria-label":"show more",children:Object(I.jsx)(k.a,{})}),Object(I.jsx)(T.a,{in:this.state.contentExpanded,timeout:"auto",unmountOnExit:!0,children:Object(I.jsx)(C.a,{children:Object(I.jsx)(w.a,{style:{wordWrap:"break-word"},children:this.props.content})})}),Object(I.jsxs)(f.a,{children:[Object(I.jsx)(g.a,{variant:"contained",disabled:!t,onClick:this.handleShowReplies,children:"Open"}),Object(I.jsx)(D,{showReplies:this.state.showReplies,handleCloseShowReplies:this.handleCloseShowReplies,replies:this.state.replies}),Object(I.jsx)(g.a,{variant:"contained",disabled:t,onClick:this.handleClickOpenReply,children:"Reply"}),Object(I.jsx)(W,{postId:this.props.id,replyToPostOpen:this.state.replyToPostOpen,handleCloseReply:this.handleCloseReply,replyToPost:this.props.replyToPost}),Object(I.jsxs)(w.a,{variant:"overline",display:"block",sx:{m:2},gutterBottom:!0,children:["Close at ",e]})]})]})})}}]),n}(a.Component),Y=L,N=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return Object(I.jsx)(y.a,{spacing:2,sx:{m:2},children:this.props.posts.map((function(t,n){return Object(I.jsx)(Y,{id:t.id,title:t.title,content:t.content,author:t.author,closeTimestamp:t.closeTimestamp,replyToPost:e.props.replyToPost,publicSquare:e.props.publicSquare},t.id)}))})}}]),n}(a.Component),U=N,z=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={title:"",content:"",hours:0},a.handleTitleChange=a.handleTitleChange.bind(Object(h.a)(a)),a.keyPressForTitle=a.keyPressForTitle.bind(Object(h.a)(a)),a.handleContentChange=a.handleContentChange.bind(Object(h.a)(a)),a.handleHoursChange=a.handleHoursChange.bind(Object(h.a)(a)),a.handleCreate=a.handleCreate.bind(Object(h.a)(a)),a}return Object(p.a)(n,[{key:"handleTitleChange",value:function(e){this.setState({title:e.target.value})}},{key:"keyPressForTitle",value:function(e){13===e.keyCode&&this.setState({title:"".concat(e.target.value,"\\n")})}},{key:"handleContentChange",value:function(e){this.setState({content:e.target.value})}},{key:"handleHoursChange",value:function(e){this.setState({hours:e.target.value})}},{key:"handleCreate",value:function(e){e.preventDefault(),this.props.createPost(this.state.title,this.state.content,this.state.hours)}},{key:"render",value:function(){return Object(I.jsxs)(E.a,{open:this.props.createPostOpen,onClose:this.props.handleClose,children:[Object(I.jsx)(M.a,{children:"Create a post"}),Object(I.jsxs)(B.a,{children:[Object(I.jsx)(F.a,{children:"To create a post, enter title, content and number of hours before close. People will not be able to reply after the close time and the replies will be released all at once at close time."}),Object(I.jsxs)(y.a,{spacing:2,sx:{width:"98%",m:2},children:[Object(I.jsx)(R.a,{id:"outlined-multiline-static",label:"Title",multiline:!0,rows:2,value:this.state.title,onChange:this.handleTitleChange,placeholder:"Title"}),Object(I.jsx)(R.a,{id:"outlined-multiline-static",label:"Content",multiline:!0,rows:4,value:this.state.content.replace(/\u21b5/g,"\n"),onChange:this.handleContentChange,placeholder:"Content"}),Object(I.jsx)(R.a,{id:"outlined-number",label:"Hours before closing",type:"number",value:this.state.hours,onChange:this.handleHoursChange,InputLabelProps:{shrink:!0}})]})]}),Object(I.jsxs)(q.a,{children:[Object(I.jsx)(g.a,{onClick:this.props.handleClose,children:"Cancel"}),Object(I.jsx)(g.a,{onClick:this.handleCreate,children:"Create"})]})]})}}]),n}(s.a.Component),J=n(273),K=n.n(J);function G(){return(G=Object(l.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!window.ethereum){e.next=14;break}return e.prev=2,e.next=5,window.ethereum.request({method:"eth_requestAccounts"});case 5:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("User denied account access");case 11:t=window.ethereum,e.next=15;break;case 14:window.web3?(console.log("Legacy dapp web3..."),t=window.web3.currentProvider):window.alert("Non-Ethereum browser detected. You should consider trying MetaMask!");case 15:return e.abrupt("return",new K.a(t));case 16:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var Q=function(){return G.apply(this,arguments)},V=[{constant:!1,inputs:[{internalType:"string",name:"_title",type:"string"},{internalType:"string",name:"_content",type:"string"},{internalType:"uint256",name:"_hoursBeforeClose",type:"uint256"}],name:"createPost",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{internalType:"uint256",name:"_index",type:"uint256"}],name:"getReply",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"content",type:"string"},{internalType:"uint256",name:"closeTimestamp",type:"uint256"},{internalType:"address",name:"author",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"uint256",name:"_postId",type:"uint256"}],name:"getReplyIndicesOfPost",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"postCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"posts",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"title",type:"string"},{internalType:"string",name:"content",type:"string"},{internalType:"uint256",name:"closeTimestamp",type:"uint256"},{internalType:"address",name:"author",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"replyCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"uint256",name:"_postId",type:"uint256"},{internalType:"string",name:"_content",type:"string"}],name:"replyToPost",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],X=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={account:"",publicSquare:null,postCount:0,posts:[],loading:!0,createPostOpen:!1},a.createPost=a.createPost.bind(Object(h.a)(a)),a.replyToPost=a.replyToPost.bind(Object(h.a)(a)),a.handleClickOpen=a.handleClickOpen.bind(Object(h.a)(a)),a.handleClose=a.handleClose.bind(Object(h.a)(a)),a}return Object(p.a)(n,[{key:"componentWillMount",value:function(){var e=Object(l.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:return window.web3=e.sent,e.next=5,this.loadBlockchainData();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadBlockchainData",value:function(){var e=Object(l.a)(j.a.mark((function e(){var t,n,a,s,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.web3,e.next=3,t.eth.getAccounts();case 3:return n=e.sent,this.setState({account:n[0]}),e.prev=5,a=new t.eth.Contract(V,"0x03707134B800BD716f094e5C88Ab721Efde8b8B9"),this.setState({publicSquare:a}),e.next=10,a.methods.postCount().call();case 10:s=e.sent,this.setState({postCount:s}),i=0;case 13:if(!(i<s)){e.next=21;break}return e.next=16,a.methods.posts(i).call();case 16:o=e.sent,this.setState({posts:[].concat(Object(r.a)(this.state.posts),[o])});case 18:i++,e.next=13;break;case 21:this.setState({posts:this.state.posts.sort((function(e,t){return e.closeTimestamp-t.closeTimestamp}))}),this.setState({loading:!1}),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(5),window.alert("PublicSquare contract is only deployed on Kovan testnet.\n\n".concat(e.t0));case 28:case"end":return e.stop()}}),e,this,[[5,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"createPost",value:function(e,t,n){var a=this;this.setState({loading:!0}),this.state.publicSquare.methods.createPost(e,t,n).send({from:this.state.account}).once("receipt",(function(e){a.setState({loading:!1}),window.location.reload()})).on("error",(function(e){alert(e),window.location.reload()})),this.handleClose()}},{key:"replyToPost",value:function(e,t){var n=this;this.setState({loading:!0}),this.state.publicSquare.methods.replyToPost(e,t).send({from:this.state.account}).once("receipt",(function(e){n.setState({loading:!1})})).on("error",(function(e){alert(e)}))}},{key:"handleClickOpen",value:function(){this.setState({createPostOpen:!0})}},{key:"handleClose",value:function(){this.setState({createPostOpen:!1})}},{key:"render",value:function(){return Object(I.jsxs)("div",{className:"App",children:[Object(I.jsx)("header",{className:"App-header",children:Object(I.jsxs)(y.a,{direction:"row",spacing:5,children:[Object(I.jsx)(w.a,{variant:"h4",children:"Public Square"}),Object(I.jsx)(g.a,{variant:"contained",onClick:this.handleClickOpen,children:"Create Post"}),Object(I.jsxs)(w.a,{variant:"h4",children:[this.state.postCount," Posted"]}),Object(I.jsx)(z,{createPostOpen:this.state.createPostOpen,handleClose:this.handleClose,createPost:this.createPost})]})}),Object(I.jsx)("body",{children:Object(I.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(I.jsxs)(y.a,{spacing:2,direction:"column",sx:{m:2},children:[Object(I.jsx)(x.a,{style:{backgroundColor:"#99a4aa"},children:Object(I.jsx)(s.a.Fragment,{children:Object(I.jsxs)(C.a,{align:"left",children:[Object(I.jsxs)(w.a,{style:{wordWrap:"break-word"},color:"text.secondary",children:["This is a \u201creddit\u201d-like site with backend smart contract running on Ethereum. ",Object(I.jsx)("b",{children:"You can create posts, reply to other people\u2019s posts."}),Object(I.jsx)("br",{}),"A few things to note:",Object(I.jsx)("br",{}),"\xa0\xa01. Posts will show up instantly. But you will be setting ",Object(I.jsx)("b",{children:"# of HOURS BEFORE CLOSE"})," on your posts. People can reply to your posts before close time. And the replies will only be accessible after the close time. So no one influences other people\u2019s thoughts.",Object(I.jsx)("br",{}),"\xa0\xa02. You\u2019ll be paying gas fees to post and reply, fees vary depending on the content.",Object(I.jsx)("br",{}),"\xa0\xa03. This is a learning project, could potentially break in unexpected ways. Play at your own risk. You can contact me if you wish."]}),Object(I.jsxs)(y.a,{spacing:2,direction:"row",sx:{m:2},children:[Object(I.jsx)(w.a,{variant:"overline",display:"block",color:"common.white",children:Object(I.jsx)("a",{href:"https://twitter.com/Cashmeregoat21",children:"DM @Cashmeregoat21"})}),Object(I.jsx)(w.a,{variant:"overline",display:"block",color:"common.white",children:Object(I.jsx)("a",{href:"mailto:cashmeregoat21@protonmail.com",children:"E-Mail to cashmeregoat21@"})})]})]})})}),Object(I.jsx)(U,{posts:this.state.posts,replyToPost:this.replyToPost,publicSquare:this.state.publicSquare})]})})})]})}}]),n}(s.a.Component),Z=X,$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,650)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),i(e),o(e)}))};o.a.render(Object(I.jsx)(Z,{}),document.getElementById("root")),$()}},[[588,1,2]]]);
//# sourceMappingURL=main.cfe0bf37.chunk.js.map